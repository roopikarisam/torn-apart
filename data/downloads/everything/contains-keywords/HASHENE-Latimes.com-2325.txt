California lawmakers on Saturday passed a "sanctuary state" bill to protect immigrants without legal residency in the U.S., part of a broader push by Democrats to counter expanded deportation orders under the Trump administration.

The legislation by Sen. Kevin de Le贸n (D-Los Angeles), the most far-reaching of its kind in the country, would limit state and local law enforcement communication with federal immigration authorities, and prevent officers from questioning and holding people on immigration violations.

After passionate debate in both houses of the Legislature, staunch opposition from Republican sheriffs and threats from Trump administration officials against sanctuary cities, Senate Bill 54 was approved Saturday with a 27-11 vote along party lines. But the bill sent to Gov. Jerry Brown drastically scaled back the version first introduced, the result of tough negotiations between Brown and De Le贸n in the final weeks of the legislative session.

The decision came hours after a federal judge in Chicago blocked the Trump administration's move to withhold Justice Department grant funds to discourage so-called sanctuary city policies.

On the Senate floor minutes before 2 a.m. on Saturday, De Le贸n said the changes were reasonable, and reflected a powerful compromise between law enforcement officials and advocates.

"These amendments do not mean to erode the core mission of this measure, which is to protect hardworking families that have contributed greatly to our culture and the economy," he said. "This is a measure that reflects the values of who we are as a great state."

Officially dubbed the "California Values Act," the legislation initially would have prohibited state and local law enforcement agencies from using any resources to hold, question or share information about people with federal immigration agents, unless they had violent or serious criminal convictions.

After talks with Brown, amendments to the bill made this week would allow federal immigration authorities to keep working with state corrections officials and to continue entering county jails to question immigrants. The legislation would also permit police and sheriffs to share information and transfer people to immigration authorities if they have been convicted of one or more crimes from a list of 800 outlined in a previous law, the California Trust Act.

Some immigrant rights advocates who were previously disappointed with the list of offenses under the Trust Act, were dismayed to see the same exceptions applied in the so-called sanctuary state bill. The list includes many violent and serious crimes, as well as some nonviolent charges and "wobblers," offenses that can be charged as a felony or misdemeanor, which advocates said has the potential to ensnare people who do not pose a danger to the public.

But immigrant rights groups did not withdraw their support for Senate Bill 54 and also won some concessions. Under the additions to the bill, the California Department of Corrections and Rehabilitation would have to develop new standards to protect people held on immigration violations, and to allow immigrant inmates to receive credits toward their sentences serviced if they undergo rehabilitation and educational programs while incarcerated.

The state attorney general's office would have to develop recommendations that limit immigration agents' access to personal information. The attorney general also has broad authority under the state constitution to ensure that police and sheriffs agencies follow SB 54's provisions should it be signed into law.

"This was a hard-fought effort, but the end product was worth the fight," Jennie Pasquarella, immigrants' rights director with the ACLU of California, said in a statement Saturday.

The compromise helped draw support for the bill from Assembly Speaker Anthony Rendon (D-Paramount), and moved the California Police Chiefs Assn.'s official position from opposed to neutral. The California Sheriffs Assn. remained opposed.

In a statement Saturday, Thomas Homan, acting director of Immigration and Customs Enforcement, said California politicians had "chosen to prioritize politics over public safety."

"This bill severely undermines that effort and will make California communities less safe," said Homan, who hosted a March town hall with Republican Sacramento County Sheriff Scott Jones on immigration enforcement that erupted in protests.

In their respective chambers on Friday, at least 20 members of the Assembly and six members of the Senate took the floor for debate on the bill, voicing complex stances on illegal immigration, federalism and the diversity of families in California.

Assemblyman Steven Choi (R-Irvine), a first-generation immigrant from South Korea, argued that he came to the U.S. legally and said the bill created "chaos" for a country built on law and order.

Others pointed to the opposition from sheriffs organizations, saying SB 54 tied officers' hands, allowing serial thieves, chronic drug abusers and gang members to slip through the cracks.

Supporters countered the Trump administration was trying to paint all immigrants in the country illegally as criminals.

They pointed to provisions in the bill that would make hospitals, schools and courthouses safe zones for immigrants from federal immigration authorities at a time of fear for some communities.

"We are ironically ending this session the way we started, talking about protecting the most vulnerable among us," Sen. Ricardo Lara (D-Bell Gardens) said.

De Le贸n introduced SB 54 on what was an unusually acrimonious first day of the 2017 legislative session, as lawmakers in both chambers were locked in bitter debate over the still newly elected President Trump.

It was at the center of a legislative package filed by Democrats in an attempt to protect more than 2.3 million people living in the state illegally. Other legislative proposals and budget deals have expanded workplace protections against raids from U.S. Immigration and Customs Enforcement, and increased legal defense services for immigrants facing deportation and financial aid for students without legal residency.

Senate Bill 54 received national attention as the U.S. Department of Justice pledged to slash government grants for law enforcement from any so-called sanctuary cities, which limit the collaboration between local and federal authorities on immigration enforcement.

In a statement Saturday, Department of Justice spokesman Devin O'Malley said "state lawmakers inexplicably voted today to return criminal aliens back onto our streets."

"This abandonment of the rule of law by the Legislature continues to put Californians at risk, and undermines national security and law enforcement," he said.

At the request of the California Senate earlier this year, former U.S. Atty. Gen. Eric H Holder Jr. reviewed the bill and said it passed constitutional muster, adding that the states "have the power over the health and safety of their residents and allocation of state resources."

Still, debate raged on and divided even law enforcement officials and associations. In Los Angeles, Police Chief Charlie Beck voiced his support, while L.A. County Sheriff Jim McDonnell was a vocal opponent.

In a statement Saturday, McDonnell said the final version of the bill was not perfect, but "reflects much of what the LASD implemented years ago and the work is well underway."

On Friday, lawmakers said some children without legal status were too afraid to go to school, while police statistics showed a drop in reports of sexual assault and domestic violence as immigrant victims refused to come forward.

Assemblywoman Cristina Garcia (D-Bell Gardens) said the era was reminiscent of the 1980s, when her father dreaded immigration raids.

"We are not living in a hypothetical fear," she said. "That fear is a reality."

jazmine.ulloa@latimes.com

@jazmineulloa

ALSO:

How California's Trust Act shaped the debate on the new 'sanctuary state' proposal

What you need to know about California's 'sanctuary state' bill and how it would work

Here's why law enforcement groups are divided on legislation to turn California into a 'sanctuary state'

L.A. Police Chief Charlie Beck endorses 'sanctuary state' bill that Eric Holder hails as 'constitutional'

L.A. County sheriff opposes 'sanctuary state' bill, saying it would hinder law enforcement

California Justice Department would oversee all shared gang databases across the state under bill sent to governor

Updates on California politics

UPDATES:

1:55 p.m.: This article was updated with statements from the U.S. Department of Justice, Immigration and Customs Enforcement and immigrant advocates.

10:40 a.m.: This article was updated with additional details about a federal court order against the Trump administration and reaction from Los Angeles County Sheriff Jim McDonnell.

This article was originally published at 3:40 a.m.